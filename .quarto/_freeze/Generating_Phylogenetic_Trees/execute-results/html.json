{
  "hash": "62c4c12e0419a1726e58f60d69da460e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Generating Phylogenetic Trees\"\neditor: visual\njupyter: python3\n---\n\n\n\n\nA phylogenetic tree or phylogeny shows the evolutionary history between a set of species or taxa during a specific time. It can be used to indicate similarities between sequences or help identify clusters or lineages.\n\nThere are several different tools to help you build trees.\n\nWe will first build a more simplified tree using [MAFFT](https://github.com/GSLBiotech/mafft) (for alignment) and [IQ-TREE](https://github.com/iqtree/iqtree3) (estimates Maximum-Likelihood Phylogeny). We will then use [Figtree](https://github.com/rambaut/figtree) for visualization.\n\nMake sure you have read through and completed any tasks in the **Preparation and Reference collection** chapter.\n\n**Now make sure you are in the right path**\n\n``` bash\ncd /mnt/viro0002-data/sequencedata/processed/Diagnostics_metagenomics/Viro_Run_0001/barcode01/Tree/\n```\n\n## Sequence alignment using MAFFT\n\nWe will continue with our RVA example. We first need to align all our sequences.\n\n``` bash\nmafft -s RVA_sequences.fasta > sequences_aligned.fasta\n```\n\nğŸ”¹<strong style=\"color:darkblue\">-s RVA_sequences.fasta</strong> â€“ Specifies the input sequences in FASTA format. This is your â€œpathogen_of_interest_sequencesâ€ (in this case, Rotavirus A sequences).\n\n::: callout-warning\n## Warning\n\nIts important to always check your new alignment file to see if there are any sequences causing problems (e.g adding extra gaps) and remove them. Then re-run the alignment again.\n:::\n\n![Example 1 - In this case, you could remove the problematic sequence if its only present in one reference](alignment_problem.jpg)\n\n![Example 2 - An example of a high-quality alignment (e.g., no gaps, high similarity, proper coverage)](alignment_better.jpg)\n\n## Generating phylogenetic trees using IQ-Tree\n\nNow that you have your alignment, copy the command below:\n\n``` bash\niqtree -s sequences_aligned.fasta -bb 1000 -st DNA -nt 16 -alrt 1000 -pre treefileout\n```\n\nğŸ”¹<strong style=\"color:darkblue\">-s sequences_aligned.fasta</strong> â€“ Specifies the input alignment file in FASTA format. This should contain multiple aligned sequences (in this case, Rotavirus A sequences).\n\nğŸ”¹<strong style=\"color:darkblue\">-bb 1000</strong> â€“ Performs ultrafast bootstrap analysis with 1000 replicates to assess the support for each branch in the phylogenetic tree.\n\nğŸ”¹<strong style=\"color:darkblue\">-st DNA</strong> â€“ Indicates that the input sequences are DNA (nucleotide) sequences.\n\nğŸ”¹<strong style=\"color:darkblue\">-nt 16</strong> â€“ Uses 16 CPU threads for computation, speeding up the tree-building process.\n\nğŸ”¹<strong style=\"color:darkblue\">-alrt 1000</strong> â€“ Runs an approximate likelihood-ratio test (aLRT) with 1000 replicates to calculate additional support values for tree branches.\n\nğŸ”¹<strong style=\"color:darkblue\">-pre treefileout</strong> â€“ Defines the prefix for all output files, such as treefileout.treefile\n\n## Visualization using Figtree\n\n[FigTree](https://github.com/rambaut/figtree) is a free and open sourced tree visualization tool. Although its not always suitable for large datasets and is primarily designed for rooted trees, its a quick tool to visualize your initial trees.\n\nStart up Figtree and select open (select your new tree - **treefileout.contree**)\n\n-root in the middle, align tip labels, tip shapes, branch labels (display by bootstrap)\n\nPlease see the figure below as an example: ![Simple tree](figtree.jpg)\n\n",
    "supporting": [
      "Generating_Phylogenetic_Trees_files"
    ],
    "filters": [],
    "includes": {}
  }
}